function Auth(){this.maskWrapper=$(".mask-wrapper")}function sleep(t){for(var n=(new Date).getTime();!((new Date).getTime()-n>t););}function FrontBase(){}$(function(){$("#btn").click(function(){$(".mask-wrapper").show()}),$(".close-btn").click(function(){$(".mask-wrapper").hide()})}),$(function(){$(".switch_signup").click(function(){$(".scroll-wrapper").css({left:-400})}),$(".switch_signin").click(function(){$(".scroll-wrapper").css({left:0})})}),Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSigninEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this;$(".signIn-btn").click(function(){t.showEvent(),$(".scroll-wrapper").css({left:0})}),$(".signup-btn").click(function(){t.showEvent(),$(".scroll-wrapper").css({left:-400})}),$(".close-btn").click(function(){t.hideEvent()})},Auth.prototype.listenSigninEvent=function(){var s=this,t=$(".signin-group"),o=t.find("input[name='telephone']"),a=t.find("input[name='password']"),i=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=o.val(),n=a.val(),e=i.prop("checked");$.ajax({type:"post",url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},async:!0,dataType:"json",success:function(t){if(200==t.code)s.hideEvent(),window.location.reload();else if("string"==typeof(n=t.message)&&""!=n)window.messageBox.show(n);else{var n=t.data;for(var e in n){var o=n[e][0];window.messageBox.show(o)}}},error:function(t){console.log(t)}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功！"),t.smsCaptcha.addClass("disabled");var n=10;t.smsCaptcha.unbind("click");var e=setInterval(function(){t.smsCaptcha.text(n+"s"),--n<=0&&(clearInterval(e),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,t=$(".sms-captcha-btn"),e=$(".signup-group input[name='telephone']");t.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码！"),$.ajax({type:"get",url:"/account/sms_captcha/",data:{telephone:t},async:!0,dataType:"json",success:function(t){200==t.code&&n.smsSuccessEvent()},error:function(t){console.log(t)}})})},FrontBase.prototype.run=function(){this.listenAuthBoxHover(),this.handleNavStatus()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},FrontBase.prototype.handleNavStatus=function(){var t=window.location.href,n=window.location.protocol+"//"+window.location.host,o=t.replace(n,"");$(".nav li").each(function(t,n){var e=$(n);if(e.children("a").attr("href")===o)return e.addClass("active"),!1})},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()});